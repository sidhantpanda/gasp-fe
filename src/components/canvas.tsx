import React, { useState } from 'react';
import { Layer, Rect, Stage, Group } from 'react-konva';
import Slider, { Range } from 'rc-slider';
import { Polygon } from '@react-google-maps/api';
import 'rc-slider/assets/index.css';
import GaspData from '../types/GaspData';
import GMap from './map';
import "react-datepicker/dist/react-datepicker.css";

interface CanvasProps {
  data: GaspData | undefined,
  field: string,
  range: number[]
}

const mapData = {
  "cell_0_0": {
    "name": "cell_0_0",
    "polygon": [
      [
        60.12705993652344,
        24.831878662109375
      ],
      [
        60.1414909362793,
        24.853557586669922
      ]
    ]
  },
  "cell_0_1": {
    "name": "cell_0_1",
    "polygon": [
      [
        60.12705993652344,
        24.855363845825195
      ],
      [
        60.1414909362793,
        24.877042770385742
      ]
    ]
  },
  "cell_0_2": {
    "name": "cell_0_2",
    "polygon": [
      [
        60.12705993652344,
        24.878849029541016
      ],
      [
        60.1414909362793,
        24.900527954101562
      ]
    ]
  },
  "cell_0_3": {
    "name": "cell_0_3",
    "polygon": [
      [
        60.12705993652344,
        24.90233612060547
      ],
      [
        60.1414909362793,
        24.924013137817383
      ]
    ]
  },
  "cell_0_4": {
    "name": "cell_0_4",
    "polygon": [
      [
        60.12705993652344,
        24.92582130432129
      ],
      [
        60.1414909362793,
        24.947498321533203
      ]
    ]
  },
  "cell_0_5": {
    "name": "cell_0_5",
    "polygon": [
      [
        60.12705993652344,
        24.94930648803711
      ],
      [
        60.1414909362793,
        24.970983505249023
      ]
    ]
  },
  "cell_0_6": {
    "name": "cell_0_6",
    "polygon": [
      [
        60.12705993652344,
        24.97279167175293
      ],
      [
        60.1414909362793,
        24.994468688964844
      ]
    ]
  },
  "cell_0_7": {
    "name": "cell_0_7",
    "polygon": [
      [
        60.12705993652344,
        24.99627685546875
      ],
      [
        60.1414909362793,
        25.017955780029297
      ]
    ]
  },
  "cell_0_8": {
    "name": "cell_0_8",
    "polygon": [
      [
        60.12705993652344,
        25.01976203918457
      ],
      [
        60.1414909362793,
        25.041440963745117
      ]
    ]
  },
  "cell_0_9": {
    "name": "cell_0_9",
    "polygon": [
      [
        60.12705993652344,
        25.04324722290039
      ],
      [
        60.1414909362793,
        25.059505462646484
      ]
    ]
  },
  "cell_1_0": {
    "name": "cell_1_0",
    "polygon": [
      [
        60.14239501953125,
        24.831878662109375
      ],
      [
        60.15682601928711,
        24.853557586669922
      ]
    ]
  },
  "cell_1_1": {
    "name": "cell_1_1",
    "polygon": [
      [
        60.14239501953125,
        24.855363845825195
      ],
      [
        60.15682601928711,
        24.877042770385742
      ]
    ]
  },
  "cell_1_2": {
    "name": "cell_1_2",
    "polygon": [
      [
        60.14239501953125,
        24.878849029541016
      ],
      [
        60.15682601928711,
        24.900527954101562
      ]
    ]
  },
  "cell_1_3": {
    "name": "cell_1_3",
    "polygon": [
      [
        60.14239501953125,
        24.90233612060547
      ],
      [
        60.15682601928711,
        24.924013137817383
      ]
    ]
  },
  "cell_1_4": {
    "name": "cell_1_4",
    "polygon": [
      [
        60.14239501953125,
        24.92582130432129
      ],
      [
        60.15682601928711,
        24.947498321533203
      ]
    ]
  },
  "cell_1_5": {
    "name": "cell_1_5",
    "polygon": [
      [
        60.14239501953125,
        24.94930648803711
      ],
      [
        60.15682601928711,
        24.970983505249023
      ]
    ]
  },
  "cell_1_6": {
    "name": "cell_1_6",
    "polygon": [
      [
        60.14239501953125,
        24.97279167175293
      ],
      [
        60.15682601928711,
        24.994468688964844
      ]
    ]
  },
  "cell_1_7": {
    "name": "cell_1_7",
    "polygon": [
      [
        60.14239501953125,
        24.99627685546875
      ],
      [
        60.15682601928711,
        25.017955780029297
      ]
    ]
  },
  "cell_1_8": {
    "name": "cell_1_8",
    "polygon": [
      [
        60.14239501953125,
        25.01976203918457
      ],
      [
        60.15682601928711,
        25.041440963745117
      ]
    ]
  },
  "cell_1_9": {
    "name": "cell_1_9",
    "polygon": [
      [
        60.14239501953125,
        25.04324722290039
      ],
      [
        60.15682601928711,
        25.059505462646484
      ]
    ]
  },
  "cell_2_0": {
    "name": "cell_2_0",
    "polygon": [
      [
        60.15773010253906,
        24.831878662109375
      ],
      [
        60.17216110229492,
        24.853557586669922
      ]
    ]
  },
  "cell_2_1": {
    "name": "cell_2_1",
    "polygon": [
      [
        60.15773010253906,
        24.855363845825195
      ],
      [
        60.17216110229492,
        24.877042770385742
      ]
    ]
  },
  "cell_2_2": {
    "name": "cell_2_2",
    "polygon": [
      [
        60.15773010253906,
        24.878849029541016
      ],
      [
        60.17216110229492,
        24.900527954101562
      ]
    ]
  },
  "cell_2_3": {
    "name": "cell_2_3",
    "polygon": [
      [
        60.15773010253906,
        24.90233612060547
      ],
      [
        60.17216110229492,
        24.924013137817383
      ]
    ]
  },
  "cell_2_4": {
    "name": "cell_2_4",
    "polygon": [
      [
        60.15773010253906,
        24.92582130432129
      ],
      [
        60.17216110229492,
        24.947498321533203
      ]
    ]
  },
  "cell_2_5": {
    "name": "cell_2_5",
    "polygon": [
      [
        60.15773010253906,
        24.94930648803711
      ],
      [
        60.17216110229492,
        24.970983505249023
      ]
    ]
  },
  "cell_2_6": {
    "name": "cell_2_6",
    "polygon": [
      [
        60.15773010253906,
        24.97279167175293
      ],
      [
        60.17216110229492,
        24.994468688964844
      ]
    ]
  },
  "cell_2_7": {
    "name": "cell_2_7",
    "polygon": [
      [
        60.15773010253906,
        24.99627685546875
      ],
      [
        60.17216110229492,
        25.017955780029297
      ]
    ]
  },
  "cell_2_8": {
    "name": "cell_2_8",
    "polygon": [
      [
        60.15773010253906,
        25.01976203918457
      ],
      [
        60.17216110229492,
        25.041440963745117
      ]
    ]
  },
  "cell_2_9": {
    "name": "cell_2_9",
    "polygon": [
      [
        60.15773010253906,
        25.04324722290039
      ],
      [
        60.17216110229492,
        25.059505462646484
      ]
    ]
  },
  "cell_3_0": {
    "name": "cell_3_0",
    "polygon": [
      [
        60.173065185546875,
        24.831878662109375
      ],
      [
        60.187496185302734,
        24.853557586669922
      ]
    ]
  },
  "cell_3_1": {
    "name": "cell_3_1",
    "polygon": [
      [
        60.173065185546875,
        24.855363845825195
      ],
      [
        60.187496185302734,
        24.877042770385742
      ]
    ]
  },
  "cell_3_2": {
    "name": "cell_3_2",
    "polygon": [
      [
        60.173065185546875,
        24.878849029541016
      ],
      [
        60.187496185302734,
        24.900527954101562
      ]
    ]
  },
  "cell_3_3": {
    "name": "cell_3_3",
    "polygon": [
      [
        60.173065185546875,
        24.90233612060547
      ],
      [
        60.187496185302734,
        24.924013137817383
      ]
    ]
  },
  "cell_3_4": {
    "name": "cell_3_4",
    "polygon": [
      [
        60.173065185546875,
        24.92582130432129
      ],
      [
        60.187496185302734,
        24.947498321533203
      ]
    ]
  },
  "cell_3_5": {
    "name": "cell_3_5",
    "polygon": [
      [
        60.173065185546875,
        24.94930648803711
      ],
      [
        60.187496185302734,
        24.970983505249023
      ]
    ]
  },
  "cell_3_6": {
    "name": "cell_3_6",
    "polygon": [
      [
        60.173065185546875,
        24.97279167175293
      ],
      [
        60.187496185302734,
        24.994468688964844
      ]
    ]
  },
  "cell_3_7": {
    "name": "cell_3_7",
    "polygon": [
      [
        60.173065185546875,
        24.99627685546875
      ],
      [
        60.187496185302734,
        25.017955780029297
      ]
    ]
  },
  "cell_3_8": {
    "name": "cell_3_8",
    "polygon": [
      [
        60.173065185546875,
        25.01976203918457
      ],
      [
        60.187496185302734,
        25.041440963745117
      ]
    ]
  },
  "cell_3_9": {
    "name": "cell_3_9",
    "polygon": [
      [
        60.173065185546875,
        25.04324722290039
      ],
      [
        60.187496185302734,
        25.059505462646484
      ]
    ]
  },
  "cell_4_0": {
    "name": "cell_4_0",
    "polygon": [
      [
        60.18840026855469,
        24.831878662109375
      ],
      [
        60.20283126831055,
        24.853557586669922
      ]
    ]
  },
  "cell_4_1": {
    "name": "cell_4_1",
    "polygon": [
      [
        60.18840026855469,
        24.855363845825195
      ],
      [
        60.20283126831055,
        24.877042770385742
      ]
    ]
  },
  "cell_4_2": {
    "name": "cell_4_2",
    "polygon": [
      [
        60.18840026855469,
        24.878849029541016
      ],
      [
        60.20283126831055,
        24.900527954101562
      ]
    ]
  },
  "cell_4_3": {
    "name": "cell_4_3",
    "polygon": [
      [
        60.18840026855469,
        24.90233612060547
      ],
      [
        60.20283126831055,
        24.924013137817383
      ]
    ]
  },
  "cell_4_4": {
    "name": "cell_4_4",
    "polygon": [
      [
        60.18840026855469,
        24.92582130432129
      ],
      [
        60.20283126831055,
        24.947498321533203
      ]
    ]
  },
  "cell_4_5": {
    "name": "cell_4_5",
    "polygon": [
      [
        60.18840026855469,
        24.94930648803711
      ],
      [
        60.20283126831055,
        24.970983505249023
      ]
    ]
  },
  "cell_4_6": {
    "name": "cell_4_6",
    "polygon": [
      [
        60.18840026855469,
        24.97279167175293
      ],
      [
        60.20283126831055,
        24.994468688964844
      ]
    ]
  },
  "cell_4_7": {
    "name": "cell_4_7",
    "polygon": [
      [
        60.18840026855469,
        24.99627685546875
      ],
      [
        60.20283126831055,
        25.017955780029297
      ]
    ]
  },
  "cell_4_8": {
    "name": "cell_4_8",
    "polygon": [
      [
        60.18840026855469,
        25.01976203918457
      ],
      [
        60.20283126831055,
        25.041440963745117
      ]
    ]
  },
  "cell_4_9": {
    "name": "cell_4_9",
    "polygon": [
      [
        60.18840026855469,
        25.04324722290039
      ],
      [
        60.20283126831055,
        25.059505462646484
      ]
    ]
  },
  "cell_5_0": {
    "name": "cell_5_0",
    "polygon": [
      [
        60.2037353515625,
        24.831878662109375
      ],
      [
        60.21816635131836,
        24.853557586669922
      ]
    ]
  },
  "cell_5_1": {
    "name": "cell_5_1",
    "polygon": [
      [
        60.2037353515625,
        24.855363845825195
      ],
      [
        60.21816635131836,
        24.877042770385742
      ]
    ]
  },
  "cell_5_2": {
    "name": "cell_5_2",
    "polygon": [
      [
        60.2037353515625,
        24.878849029541016
      ],
      [
        60.21816635131836,
        24.900527954101562
      ]
    ]
  },
  "cell_5_3": {
    "name": "cell_5_3",
    "polygon": [
      [
        60.2037353515625,
        24.90233612060547
      ],
      [
        60.21816635131836,
        24.924013137817383
      ]
    ]
  },
  "cell_5_4": {
    "name": "cell_5_4",
    "polygon": [
      [
        60.2037353515625,
        24.92582130432129
      ],
      [
        60.21816635131836,
        24.947498321533203
      ]
    ]
  },
  "cell_5_5": {
    "name": "cell_5_5",
    "polygon": [
      [
        60.2037353515625,
        24.94930648803711
      ],
      [
        60.21816635131836,
        24.970983505249023
      ]
    ]
  },
  "cell_5_6": {
    "name": "cell_5_6",
    "polygon": [
      [
        60.2037353515625,
        24.97279167175293
      ],
      [
        60.21816635131836,
        24.994468688964844
      ]
    ]
  },
  "cell_5_7": {
    "name": "cell_5_7",
    "polygon": [
      [
        60.2037353515625,
        24.99627685546875
      ],
      [
        60.21816635131836,
        25.017955780029297
      ]
    ]
  },
  "cell_5_8": {
    "name": "cell_5_8",
    "polygon": [
      [
        60.2037353515625,
        25.01976203918457
      ],
      [
        60.21816635131836,
        25.041440963745117
      ]
    ]
  },
  "cell_5_9": {
    "name": "cell_5_9",
    "polygon": [
      [
        60.2037353515625,
        25.04324722290039
      ],
      [
        60.21816635131836,
        25.059505462646484
      ]
    ]
  },
  "cell_6_0": {
    "name": "cell_6_0",
    "polygon": [
      [
        60.21907043457031,
        24.831878662109375
      ],
      [
        60.23350143432617,
        24.853557586669922
      ]
    ]
  },
  "cell_6_1": {
    "name": "cell_6_1",
    "polygon": [
      [
        60.21907043457031,
        24.855363845825195
      ],
      [
        60.23350143432617,
        24.877042770385742
      ]
    ]
  },
  "cell_6_2": {
    "name": "cell_6_2",
    "polygon": [
      [
        60.21907043457031,
        24.878849029541016
      ],
      [
        60.23350143432617,
        24.900527954101562
      ]
    ]
  },
  "cell_6_3": {
    "name": "cell_6_3",
    "polygon": [
      [
        60.21907043457031,
        24.90233612060547
      ],
      [
        60.23350143432617,
        24.924013137817383
      ]
    ]
  },
  "cell_6_4": {
    "name": "cell_6_4",
    "polygon": [
      [
        60.21907043457031,
        24.92582130432129
      ],
      [
        60.23350143432617,
        24.947498321533203
      ]
    ]
  },
  "cell_6_5": {
    "name": "cell_6_5",
    "polygon": [
      [
        60.21907043457031,
        24.94930648803711
      ],
      [
        60.23350143432617,
        24.970983505249023
      ]
    ]
  },
  "cell_6_6": {
    "name": "cell_6_6",
    "polygon": [
      [
        60.21907043457031,
        24.97279167175293
      ],
      [
        60.23350143432617,
        24.994468688964844
      ]
    ]
  },
  "cell_6_7": {
    "name": "cell_6_7",
    "polygon": [
      [
        60.21907043457031,
        24.99627685546875
      ],
      [
        60.23350143432617,
        25.017955780029297
      ]
    ]
  },
  "cell_6_8": {
    "name": "cell_6_8",
    "polygon": [
      [
        60.21907043457031,
        25.01976203918457
      ],
      [
        60.23350143432617,
        25.041440963745117
      ]
    ]
  },
  "cell_6_9": {
    "name": "cell_6_9",
    "polygon": [
      [
        60.21907043457031,
        25.04324722290039
      ],
      [
        60.23350143432617,
        25.059505462646484
      ]
    ]
  },
  "cell_7_0": {
    "name": "cell_7_0",
    "polygon": [
      [
        60.234405517578125,
        24.831878662109375
      ],
      [
        60.248836517333984,
        24.853557586669922
      ]
    ]
  },
  "cell_7_1": {
    "name": "cell_7_1",
    "polygon": [
      [
        60.234405517578125,
        24.855363845825195
      ],
      [
        60.248836517333984,
        24.877042770385742
      ]
    ]
  },
  "cell_7_2": {
    "name": "cell_7_2",
    "polygon": [
      [
        60.234405517578125,
        24.878849029541016
      ],
      [
        60.248836517333984,
        24.900527954101562
      ]
    ]
  },
  "cell_7_3": {
    "name": "cell_7_3",
    "polygon": [
      [
        60.234405517578125,
        24.90233612060547
      ],
      [
        60.248836517333984,
        24.924013137817383
      ]
    ]
  },
  "cell_7_4": {
    "name": "cell_7_4",
    "polygon": [
      [
        60.234405517578125,
        24.92582130432129
      ],
      [
        60.248836517333984,
        24.947498321533203
      ]
    ]
  },
  "cell_7_5": {
    "name": "cell_7_5",
    "polygon": [
      [
        60.234405517578125,
        24.94930648803711
      ],
      [
        60.248836517333984,
        24.970983505249023
      ]
    ]
  },
  "cell_7_6": {
    "name": "cell_7_6",
    "polygon": [
      [
        60.234405517578125,
        24.97279167175293
      ],
      [
        60.248836517333984,
        24.994468688964844
      ]
    ]
  },
  "cell_7_7": {
    "name": "cell_7_7",
    "polygon": [
      [
        60.234405517578125,
        24.99627685546875
      ],
      [
        60.248836517333984,
        25.017955780029297
      ]
    ]
  },
  "cell_7_8": {
    "name": "cell_7_8",
    "polygon": [
      [
        60.234405517578125,
        25.01976203918457
      ],
      [
        60.248836517333984,
        25.041440963745117
      ]
    ]
  },
  "cell_7_9": {
    "name": "cell_7_9",
    "polygon": [
      [
        60.234405517578125,
        25.04324722290039
      ],
      [
        60.248836517333984,
        25.059505462646484
      ]
    ]
  },
  "cell_8_0": {
    "name": "cell_8_0",
    "polygon": [
      [
        60.24974060058594,
        24.831878662109375
      ],
      [
        60.2641716003418,
        24.853557586669922
      ]
    ]
  },
  "cell_8_1": {
    "name": "cell_8_1",
    "polygon": [
      [
        60.24974060058594,
        24.855363845825195
      ],
      [
        60.2641716003418,
        24.877042770385742
      ]
    ]
  },
  "cell_8_2": {
    "name": "cell_8_2",
    "polygon": [
      [
        60.24974060058594,
        24.878849029541016
      ],
      [
        60.2641716003418,
        24.900527954101562
      ]
    ]
  },
  "cell_8_3": {
    "name": "cell_8_3",
    "polygon": [
      [
        60.24974060058594,
        24.90233612060547
      ],
      [
        60.2641716003418,
        24.924013137817383
      ]
    ]
  },
  "cell_8_4": {
    "name": "cell_8_4",
    "polygon": [
      [
        60.24974060058594,
        24.92582130432129
      ],
      [
        60.2641716003418,
        24.947498321533203
      ]
    ]
  },
  "cell_8_5": {
    "name": "cell_8_5",
    "polygon": [
      [
        60.24974060058594,
        24.94930648803711
      ],
      [
        60.2641716003418,
        24.970983505249023
      ]
    ]
  },
  "cell_8_6": {
    "name": "cell_8_6",
    "polygon": [
      [
        60.24974060058594,
        24.97279167175293
      ],
      [
        60.2641716003418,
        24.994468688964844
      ]
    ]
  },
  "cell_8_7": {
    "name": "cell_8_7",
    "polygon": [
      [
        60.24974060058594,
        24.99627685546875
      ],
      [
        60.2641716003418,
        25.017955780029297
      ]
    ]
  },
  "cell_8_8": {
    "name": "cell_8_8",
    "polygon": [
      [
        60.24974060058594,
        25.01976203918457
      ],
      [
        60.2641716003418,
        25.041440963745117
      ]
    ]
  },
  "cell_8_9": {
    "name": "cell_8_9",
    "polygon": [
      [
        60.24974060058594,
        25.04324722290039
      ],
      [
        60.2641716003418,
        25.059505462646484
      ]
    ]
  },
  "cell_9_0": {
    "name": "cell_9_0",
    "polygon": [
      [
        60.26507568359375,
        24.831878662109375
      ],
      [
        60.27409362792969,
        24.853557586669922
      ]
    ]
  },
  "cell_9_1": {
    "name": "cell_9_1",
    "polygon": [
      [
        60.26507568359375,
        24.855363845825195
      ],
      [
        60.27409362792969,
        24.877042770385742
      ]
    ]
  },
  "cell_9_2": {
    "name": "cell_9_2",
    "polygon": [
      [
        60.26507568359375,
        24.878849029541016
      ],
      [
        60.27409362792969,
        24.900527954101562
      ]
    ]
  },
  "cell_9_3": {
    "name": "cell_9_3",
    "polygon": [
      [
        60.26507568359375,
        24.90233612060547
      ],
      [
        60.27409362792969,
        24.924013137817383
      ]
    ]
  },
  "cell_9_4": {
    "name": "cell_9_4",
    "polygon": [
      [
        60.26507568359375,
        24.92582130432129
      ],
      [
        60.27409362792969,
        24.947498321533203
      ]
    ]
  },
  "cell_9_5": {
    "name": "cell_9_5",
    "polygon": [
      [
        60.26507568359375,
        24.94930648803711
      ],
      [
        60.27409362792969,
        24.970983505249023
      ]
    ]
  },
  "cell_9_6": {
    "name": "cell_9_6",
    "polygon": [
      [
        60.26507568359375,
        24.97279167175293
      ],
      [
        60.27409362792969,
        24.994468688964844
      ]
    ]
  },
  "cell_9_7": {
    "name": "cell_9_7",
    "polygon": [
      [
        60.26507568359375,
        24.99627685546875
      ],
      [
        60.27409362792969,
        25.017955780029297
      ]
    ]
  },
  "cell_9_8": {
    "name": "cell_9_8",
    "polygon": [
      [
        60.26507568359375,
        25.01976203918457
      ],
      [
        60.27409362792969,
        25.041440963745117
      ]
    ]
  },
  "cell_9_9": {
    "name": "cell_9_9",
    "polygon": [
      [
        60.26507568359375,
        25.04324722290039
      ],
      [
        60.27409362792969,
        25.059505462646484
      ]
    ]
  }
}

const Canvas = (props: CanvasProps) => {
  const increment = 5.53;
  const [sliderValue, setSliderValue] = useState(increment * 4);
  const [timestampIndex, setTimestampIndex] = useState(4);
  const [selectedSilderDate, setSelectedSliderDate] = useState(new Date(props!.data!.timestamps[4]));
  if (!props || !props.data) {
    return <></>;
  }
  const height = window.innerHeight * 0.8;
  const width = window.innerWidth * 0.8;

  const cellHeight = height / 10;
  const cellWidth = width / 10;

  const polygons = [];

  console.log('props.field', props.field);
  for (let i = 0; i < 10; i++) {
    for (let j = 0; j < 10; j++) {
      // create reacts
      const key = `cell_${i}_${j}`;
      if (props.data.grid[key][props.field]) {
        const intensityCoefficient =
          (props.data.grid[key][props.field][timestampIndex] - props.range[0])
          / (props.range[1] - props.range[0]) * 100;


        console.log('ffjkjkfjkfjffj', (mapData as any));
        const paths = [
          {
            lat: (mapData as any)[key].polygon[0][0], lng: (mapData as any)[key].polygon[0][1]
          },
          {
            lat: (mapData as any)[key].polygon[0][0], lng: (mapData as any)[key].polygon[1][1]
          },
          {
            lat: (mapData as any)[key].polygon[1][0], lng: (mapData as any)[key].polygon[1][1]
          },
          {
            lat: (mapData as any)[key].polygon[1][0], lng: (mapData as any)[key].polygon[0][1]
          },
          {
            lat: (mapData as any)[key].polygon[0][0], lng: (mapData as any)[key].polygon[0][1]
          }
        ]

        const options = {
          fillColor: "#2559af",
          fillOpacity: intensityCoefficient * 0.6,
          strokeColor: "blue",
          strokeOpacity: 0,
          strokeWeight: 0,
          clickable: false,
          draggable: false,
          editable: false,
          geodesic: false,
          zIndex: 1
        }

        const polygon = <Polygon
          paths={paths}
          options={options}
        />
        polygons.push(polygon);
      }
    }
  }

  const sliderMarks: any = {};
  for (let i = 0, j = 1; j < props.data.timestamps.length; i += increment, j++) {
    const date = new Date(props.data.timestamps[j]);
    sliderMarks[i] = '';
  }

  const onSliderChange = (event: any) => {
    setSliderValue(event);
    const indexCeil = Math.ceil(event / increment);
    const indexFloor = Math.floor(event / increment);

    const d = event / increment;
    let index = 0;
    if (indexCeil - d < d - indexFloor) {
      index = indexCeil;
    } else {
      index = indexFloor;
    }

    setSelectedSliderDate(new Date(props!.data!.timestamps[event / increment]));
    setTimestampIndex(event / increment);
  }

  return (
    <div>
      <div
        style={{
          width: '70%',
          paddingLeft: '2em'
        }}
      >

        <br />
        <br />
        <Slider
          min={0}
          defaultValue={0}
          marks={sliderMarks}
          step={null}
          value={sliderValue}
          onChange={onSliderChange}
        />
      </div>

      <div
        style={{
          paddingLeft: '2em'
        }}
      >
        <br />
        Seeing data for {selectedSilderDate.toDateString() + ' ' + selectedSilderDate.toTimeString()}
        <br />
        <br />

        

        <GMap
          center={{
            lng: ((25.059505462646484 - 24.831878662109375) / 2) + 24.831878662109375,
            lat: ((60.26507568359375 - 60.12705993652344) / 2) + 60.12705993652344,
          }}
          zoom={10}
          data={props.data}
          range={props.range}
          polygons={polygons}
        />
      </div>

      {/* <Range /> */}



      <Stage width={width} height={height}>
        <Layer>
          {/* {cells} */}
        </Layer>
      </Stage>
    </div >
  )
};

export default Canvas;